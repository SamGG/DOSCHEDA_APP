---
title: "Linear Model Walkthrough"
author: "Piero Ricchiuto & Bruno Contrino"
output: 
  html_document:
    theme: cosmo
    toc: true
    toc_float: true
---



##Introduction

This walkthrough will explain step by step how to apply a linear model to your data using DOSCHEDA. Bare in mind that depending on your data, there are different options available to you. There is a seprate walkthrough dedicated to the sigmoidal model choice, which you can read to understnd how to choose this model option once having loaded your data in. 
The linear model must have at least 2 replicates and can take peptide intensities and protein fold changes as input. 
When uploading peptide intensities, DOSCHEDA offers the option to carry out a peptide removal process (please refer to the manual for a detailed description), this is designed to reduce the noise in your experiment by removing 'noisy' peptides from the data.

|                     |1 Replicate |More than 1 Replicate |
|:--------------------|:-----------|:---------------------|
|**Less than 5 channels** |Not enough data      |Linear                |
|**5 or more channels**   |Sigmoidal   |Linear                |

Table: Table 1: Possible analysis given your experimental design.

## Data

Your data will need to contain the fields in Table 2 if you want to apply the linear model to your data. 

|                    |Input                                                                                   |
|:-------------------|:---------------------------------------------------------------------------------------|
|**Peptide Intensities** |Peptide Qvality Score, Protein Accessions, Peptide Names, Intensities (several columns) |
|**Fold Changes**        |Protein Fold Changes (several columns)           |
|**Log-Fold Changes**    |Protein log-Fold Changes (several columns)     |

Table: Table 2: Required columns containing the following data given your data type. 


If your data includes all of the relevant fields in Table 2, DOSCHEDA will work correctly. 

## Uploading the Data

In order to begin the analysis, the data must be uploaded correctly into the application.
The following will give a step by step guide on how to upload this data.   
*All instructions in italics will be the steps to complete an analysis with DOSCHEDA for a given file that we provide in the github repositry https://github.com/brunocontrino/DOSCHEDA/tree/master/data . To use the file you must download it to your computer.*


If you are uploading intensities: 

1. Select 'Intensities' in the '**Data  Type:**' section.

2. Select your file type from the options in the '**File Type:**'  
  *Select the 'csv' option*
  + To use the Peptide removal process, select **Yes** in the **Do removal:** set of radio buttons.

3. Go to the '**Choose File**' section and click 'Browse...' and select the file you would like to analyse.  
      *Select the LinearIntensity.csv from your computer*

4. Select the correct number of channels and replicates in the '**\#Channels**' and '**\#Replicates**' section respectively.    
  *In the '\# Channels' box put 6. In the '\# Replicates' box put 2.*

5. Input the columns with the correct intensities in the box which appears with a random selection of your data column names.  
  *The columns to import are 'Abundance..F1..126..Control..REP_1', 'Abundance..F1..127..Sample..REP_1', 'Abundance..F1..128..Sample..REP_1', 'Abundance..F1..129..Sample..REP_1', 'Abundance..F1..130..Sample..REP_1', 'Abundance..F1..131..Sample..REP_1', 'Abundance..F2..126..Control..REP_2', 'Abundance..F2..127..Sample..REP_2', 'Abundance..F2..128..Sample..REP_2', 'Abundance..F2..129..Sample..REP_2', 'Abundance..F2..130..Sample..REP_2', 'Abundance..F2..131..Sample..REP_2'*
  
6. Go to the '**Choose Sequence**' drop down list and select the column name for the column containing the peptide sequences in your data.  
*Select 'Sequence'*

7. Go to the '**Select Peptide Qvality Score:**' drop down list and select the column containing peptide qvality score.  
  *Select 'Qvality.PEP'*
  
8. Go to the '**Choose Accession**' drop down list and select the column containing protein accessions.  
  *Select Master.Accessions*

11. Select one of the plot tabs and wait for the loading sign in the top left to finish.  


If you are uploading protein fold changes: 

1. Select 'FC' or 'Log FC' in the '**Data  Type:**' section. 
 *Select 'Log FC'*

2. Select your file type from the options in the '**File Type:**'
  *Select 'xlsx'*

3. Go to the '**Choose File**' section and click 'Browse...' and select the file you would like to analyse.  
*Select the LinearFC.csv from your computer*

4. Select the correct number of channels and replicates in the '**\#Channels**' and '**\#Replicates**' section respectively.  
  *In the '\# Channels' box put 3. In the '\# Replicates' box put 2.*


5. Input the columns with the correct fold changes in the box which appears with a random selection of your data column names. 
  *The columns to import are 'A6..114.115_norm_log2',	'A6..114.116_norm_log2',	'A6..114.117_norm_log2',	'B6..114.115_norm_log2',	'B6..114.116_norm_log2',	'B6..114.117_norm_log2'*  
  
+ If you are using data which is not from PD 2.1 the you must tick the 'Data NOT PD 2.1 put the column selecting the \# of Unique Peptides from your data and the data column containing the protein accession numbers from their respective drop down list.


11. Select one of the plot tabs and wait for the loading sign in the top left to return to the DOSCHEDA logo. 

## CRAPome

By changing the organism of in the 'Select your organism' tab, a different CRAPome data set will be used to calculate the CRAPome percentages seen in the final data set. These are used to give an indication of how much a given protein binds in a series of experiments, if there are proteins with high binding and a high CRAPome percentage, this could mean that the protein is simply binding in most experiments. Note that this will not affect any of the actual pipeline and thus if your organism is not available then it will not have an impact on the analysis and quality control on your data. If your organism is not available the CRAPome percentage we display the Human CRAPome.


## Plots

There are several different plots created that are designed visualise the results of the analysis and provide some quality control on the experiment. 

|Plot                          |Description                                                                                                                                                          |Type     |
|:-----------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------|:--------|
|Box                           |A box plot showing the mean and the interquartile range of each channel                                                                                              |QC       |
|Density and ranked protein    |These plots show the density distribution of each channel and the distribution of the ranked proteins                                                                |QC       |
|Venn                          |The intersection of the kinome and the inputted proteins. There is also the option to load a list of protein names and see the intersection with a personalised list |QC       |
|MeanSD                        |Shows the ranked means with a running median calculated with a window of 10%                                                                                         |QC       |
|Mean vs Difference            |Shows us the mean protein fold change and difference between different replicates                                                                                    |QC       |
|Corrgram                      |Pearson Correlation Coefficient between each channel                                                                                                                 |QC       |
|Compare Replicates            |The fold change per protein plotted against each other in each replicate                                                                                              |Analysis |
|PCA                           |Each channel is plotted in the first two principal components of the data                                                                                            |Analysis |
|Heatmap                       |Interactive heat map of the values per protein per channel                                                                                                            |Analysis |
|Linear Model: P-values        |The distribution of p-values for each coefficient of the linear model, that is the intercept, slope and quadratic                                                     |Analysis |
|Linear Model: volcano plots   |The distribution of proteins by their mean and standard deviation coloured by their p-values, there is a plot for each coefficient in the linear model                |Analysis |




## Downloading Results 

Users can save their results by clicking on the 'Downloads' tab, clicking on the 'Download Data' button to download the processed data and clicking on the 'Download Report' button to download a html report containing all the plots seen in the analysis with descriptions as well as other important elements such as the options the user has inputted for example the number of channels etc.


## More Informaion and Help 

If you would like to know more about the pipeline used in the DOSCHEDA analysis, please refer to the user manual, this can be accessed at the DOSCHEDA GitHub: https://github.com/brunocontrino/DOSCHEDA 

